{% extends "layout.html" %}

{% block pageTitle %}
GOV.UK Prototype Kit
{% endblock %}

{% block beforeContent %}

<div class="govuk-breadcrumbs">
  <ol class="govuk-breadcrumbs__list">
    <li class="govuk-breadcrumbs__list-item">
      <a class="govuk-breadcrumbs__link" href="/start">
        Home
      </a>
    </li>
    <li class="govuk-breadcrumbs__list-item">
      <a class="govuk-breadcrumbs__link" href="/v1/view-results/viewResults">
        View results
      </a>
    </li>

  </ol>

</div>

{% endblock %}

{% block content %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">

    <div class="govuk-form-group">
      <fieldset class="govuk-fieldset">
        <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">
          <h1 class="govuk-heading-xl govuk-!-margin-bottom-2">
            Select funding
          </h1>
          <span class="govuk-caption-l govuk-!-margin-bottom-6">
            Select a funding stream and period to view the provider results.
          </span>
        </legend>
        <form action="provider-results.html" method="get" no-validate data-validate='funding-stream'>

          <div class="govuk-form-group fundingStream">
            <label class="govuk-label" for="fundingStream">
              Funding stream
            </label>

            <select class="govuk-select" id="fundingstream" name="fundingStream">
              <option value=""></option>
              <option value="General annual grant (GAG)" rel="noInput">General annual grant (GAG)</option>
              <option value="Dedicated schools grant (DSG)" rel="noInput">Dedicated schools grant (DSG)</option>
              <option value="PE and sports premium (PSG)" rel="noInput">PE and sports premium (PSG)</option>
              <option value="Pupil number adjustment (PNA)" rel="noInput">Pupil number adjustment (PNA)</option>
              <option value="16 to 19" rel="16-19">16 to 19</option>
              <option value="14 to 16" rel="noInput">14 to 16</option>
              <option value="Dance and drama awards (DADA)" rel="noInput">Dance and drama awards (DADA)</option>
            </select>
            </datalist>
          </div>


          <div class="govuk-form-group fundingPeriod">
            <label class="govuk-label" for="fundingPeriod">
              Funding period
            </label>
            <select class="govuk-select" id="fundingPeriod" name="fundingPeriod">
              <option value="" class="16-19"></option>
              <option value="" class="noInput"></option>
              <option value="no Input" class="noInput">No data</option>
              <option value="16 to 19" class="16-19">Academies and Schools Year 2021-22</option>
              <option value="16 to 19" class="16-19">Academies and Schools Year 2022-23</option>
            </select>
          </div>

    </div>
  </div>
</div>

<div class="govuk-grid-row continueBtn">
  <div class="govuk-grid-column-two-thirds">
    <div class="govuk-button-group">
      <button id="specification-link" class="govuk-button" data-module="govuk-button">
        Continue
      </button>
    </div>
  </div>
</div>

</form>
</fieldset>

<script type="text/javascript" src="/public/javascripts/accessible-autocomplete.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script type="text/javascript">
  var selectEl = document.querySelector('#funding-stream')
  accessibleAutocomplete.enhanceSelectElement({
    autoselect: true,
    confirmOnBlur: true,
    defaultValue: "",
    minLength: 2,
    selectElement: selectEl
  })

  var queryStringParameters = window.location.search
  var previouslySubmitted = queryStringParameters.length > 0
  if (previouslySubmitted) {
    var submittedEl = document.querySelector('.submitted')
    submittedEl.classList.remove('submitted--hidden')
    var params = new URLSearchParams(document.location.search.split('?')[1])
    document.querySelector('.submitted__last-location').innerHTML = params.get('funding-stream')
  }
</script>

<script type="application/json" id="funding-stream">
  {
    "fundingStream": {
      "presence": {
        "message": "^Select a funding stream"
      }
    }

  }
</script>

<script>
  $(document).ready(function () {
    var $cat = $('select[name=fundingStream]'),
      $items = $('select[name=fundingPeriod]');

    $cat.change(function () {

      var $this = $(this).find(':selected'),
        rel = $this.attr('rel');

      // Hide all
      $items.find("option").hide();
      $set = $items.find('option.' + rel);
      $set.show().first().prop('selected', true);

    });
  });

    // Show period dropdown 

  $(function () {
    var hideBoxes = function () {
      $(".fundingPeriod, .continueBtn").hide();
    }

    $("select[name='fundingStream']").change(function () {
      hideBoxes();

      var value = $(this).val();
      if (value == "16 to 19", "General annual grant (GAG", "Dedicated schools grant (DSG)", "PE and sports premium (PSG)","Pupil number adjustment (PNA)", "14 to 16",
      "Dance and drama awards (DADA)") {
        $(".fundingPeriod").show();
      }
    })

    hideBoxes();
  });

  // Show continue button 

  $(function () {
        var hideBoxes = function () {
          $(".continueBtn").hide();
        }


        $("select[name='fundingPeriod']").change(function () {

          var value = $(this).val();
          if (value == "16 to 19", "General annual grant (GAG", "Dedicated schools grant (DSG)", "PE and sports premium (PSG)","Pupil number adjustment (PNA)", "14 to 16",
      "Dance and drama awards (DADA)") {
            $(".continueBtn").show();
          }
        })

          hideBoxes();
        });


</script>

{% endblock %}